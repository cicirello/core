# Triggers a snapshot build on JitPack for the custom domain.
# Already have a webhook setup, but that won't trigger the build
# for the custom domain.

name: jitpack-build

on:
  push:
    branches: [ main ]

jobs:
  jitpack:

    runs-on: ubuntu-latest

    steps:

    - name: Checkout
      uses: actions/checkout@v3

    - name: Request main-SNAPSHOT from JitPack
      run: |
        git_hash=$(git rev-parse --short "$GITHUB_SHA")
        # timeout in 10 second to avoid waiting for build
        STATUS=$(curl -m 1 https://jitpack.io/org/cicirello/core/main-${git_hash}-1/)
        exit 0
